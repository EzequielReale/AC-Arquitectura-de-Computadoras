N_CLK EQU 10
N_F10 EQU 20
TIMER EQU 10H
CONT  EQU 10H
COMP  EQU 11H
PIC   EQU 20H
EOI   EQU 20H
IMR   EQU 21H
INT0  EQU 24H
INT1  EQU 25H
INT2  EQU 26H
INT3  EQU 27H
PIO   EQU 30H
PA    EQU 30H
PB    EQU 31H
CA    EQU 32H
CB    EQU 33H
HAND_DATO EQU 40H
HAND_ESTADO EQU 41H


ORG 1000H
MENSAJE DB "SARANGANDUNGA MEREQUETENGE"
FIN DB ?

ORG 2000H
; FUERZO EL BIT MÁS SIGNIFICATIVO A 0 PARA USAR EL HANDSHAKE POR CONSULTA DE ESTADO
IN AL, HAND_ESTADO
AND AL, 01111111B
OUT HAND_ESTADO, AL

MOV BX, OFFSET MENSAJE; PONGO EN BX LA DIRECCIÓN DEL MENSAJE

POLL: IN AL, HAND_ESTADO
AND AL, 1
JNZ POLL ; SI NO DIÓ 0 LA IMPRESORA ESTÁ EN BUSY

MOV AL, [BX]; LE PASO EL CARÁCTER A AL
OUT HAND_DATO, AL; LE PASO EL CARÁCTER AL HANDSHAKE

INC BX; AVANZO AL SIGUIENTE CARÁCTER
CMP BX, OFFSET FIN
JNZ POLL; SI NO LLEGUÉ AL FINAL DEL MENSAJE JMP

;OPCIONAL: LAZO: JMP LAZO PARA IMPRESORAS LENTAS EN VONSIM

INT 0
END